<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡∏≤‡∏á‡∏™‡∏∞‡∏û‡∏≤‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* --- CSS STYLES --- */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Sarabun', Arial, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #e8f5e9 100%);
      line-height: 1.6;
      color: #2c3e50;
      min-height: 100vh;
    }
    .app-container { width: 100%; height: 100%; }
    
    .header {
      background: linear-gradient(135deg, #4caf50 0%, #2e7d32 100%);
      color: white;
      padding: 2rem 1.5rem;
      text-align: center;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .logo { font-size: 2.5rem; margin-bottom: 0.5rem; }
    .header h1 { font-size: 1.8rem; font-weight: 700; }
    
    .container { max-width: 900px; margin: 2rem auto; padding: 0 1.5rem; }
    
    .view { display: none; opacity: 0; transition: opacity 0.3s ease-in-out; }
    .view.active { display: block; opacity: 1; }
    
    .card {
      background: white;
      border-radius: 12px;
      padding: 2rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border-left: 4px solid #4caf50;
    }
    
    .form-section h2 {
      font-size: 1.4rem; color: #2e7d32; margin-bottom: 1rem;
      border-bottom: 2px solid #e0e0e0; padding-bottom: 0.5rem;
    }
    
    .form-group { margin-bottom: 1.25rem; }
    .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 600; }
    .form-control {
      width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0;
      border-radius: 8px; font-family: inherit; font-size: 1rem;
    }
    .form-control:focus { border-color: #4caf50; outline: none; }
    
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
    @media (max-width: 768px) { .form-row { grid-template-columns: 1fr; } }
    
    .btn {
      padding: 0.8rem 1.5rem; border: none; border-radius: 8px;
      font-weight: 600; cursor: pointer; font-family: inherit; font-size: 1rem;
      transition: all 0.2s;
    }
    .btn-primary { background: #2e7d32; color: white; width: 100%; }
    .btn-primary:hover { background: #1b5e20; }
    .btn-secondary { background: #757575; color: white; }
    
    .info-box { background: #e8f5e9; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; }
    .toast {
      position: fixed; bottom: 2rem; right: 2rem;
      background: #333; color: white; padding: 1rem 2rem;
      border-radius: 8px; display: none; z-index: 9999;
    }
    .toast.show { display: block; animation: fadeIn 0.5s; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    /* Table Styles */
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th { background: #2e7d32; color: white; padding: 1rem; text-align: left; }
    td { padding: 1rem; border-bottom: 1px solid #ddd; }
    .status-badge { padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.85rem; background: #e3f2fd; color: #1565c0; }
    
    .spinner {
      border: 3px solid #f3f3f3; border-top: 3px solid white;
      border-radius: 50%; width: 20px; height: 20px;
      animation: spin 1s linear infinite; display: inline-block; vertical-align: middle;
    }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  </style>
</head>
<body>

  <div class="header">
    <div class="logo">üè´</div>
    <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</h1>
    <p>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1 ‡πÅ‡∏•‡∏∞ 4</p>
  </div>

  <div class="app-container">
    
    <div id="studentLoginView" class="view active">
      <div class="container">
        <div class="card" style="max-width: 500px; margin: 2rem auto;">
          <h2 style="text-align: center; margin-bottom: 1.5rem; color: #2e7d32;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
          <form id="studentLoginForm">
            <div class="form-group">
              <label>‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô (13 ‡∏´‡∏•‡∏±‡∏Å)</label>
              <input type="text" id="studentIdCard" class="form-control" maxlength="13" placeholder="‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô" required>
            </div>
            <button type="submit" class="btn btn-primary">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö / ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
            <div style="text-align: center; margin-top: 1rem;">
              <a href="#" onclick="showView('adminLoginView')" style="color: #757575; font-size: 0.9rem;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</a>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div id="adminLoginView" class="view">
      <div class="container">
        <div class="card" style="max-width: 500px; margin: 2rem auto;">
          <h2 style="text-align: center; margin-bottom: 1.5rem; color: #c62828;">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</h2>
          <form id="adminLoginForm">
            <div class="form-group">
              <label>Username</label>
              <input type="text" id="adminUsername" class="form-control" required>
            </div>
            <div class="form-group">
              <label>Password</label>
              <input type="password" id="adminPassword" class="form-control" required>
            </div>
            <button type="submit" class="btn btn-primary" style="background: #c62828;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin</button>
            <div style="text-align: center; margin-top: 1rem;">
              <a href="#" onclick="showView('studentLoginView')" style="color: #757575;">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div id="applicationFormView" class="view">
      <div class="container">
        <div class="info-box">
          <h3>üìå ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h3>
          <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤</p>
        </div>
        <form id="applicationForm">
          <div class="card">
            <div class="form-section">
              <h2>1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h2>
              <div class="form-row">
                <div class="form-group">
                  <label>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
                  <select id="prefix" class="form-control" required>
                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>
                    <option value="‡∏î.‡∏ä.">‡∏î.‡∏ä.</option>
                    <option value="‡∏î.‡∏ç.">‡∏î.‡∏ç.</option>
                    <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                    <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                  </select>
                </div>
                <div class="form-group">
                    <label>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</label>
                    <input type="text" id="idCard" class="form-control" readonly style="background: #f0f0f0;">
                </div>
              </div>
              <div class="form-row">
                <div class="form-group"><label>‡∏ä‡∏∑‡πà‡∏≠ (‡πÑ‡∏ó‡∏¢)</label><input type="text" id="firstName" class="form-control" required></div>
                <div class="form-group"><label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡πÑ‡∏ó‡∏¢)</label><input type="text" id="lastName" class="form-control" required></div>
              </div>
              <div class="form-row">
                <div class="form-group"><label>‡∏ä‡∏∑‡πà‡∏≠ (Eng)</label><input type="text" id="firstNameEn" class="form-control"></div>
                <div class="form-group"><label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (Eng)</label><input type="text" id="lastNameEn" class="form-control"></div>
              </div>
              <div class="form-row">
                <div class="form-group"><label>‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</label><input type="date" id="birthDate" class="form-control" required></div>
                <div class="form-group"><label>‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î</label><input type="text" id="birthHospital" class="form-control"></div>
              </div>
              <div class="form-row">
                 <div class="form-group">
                    <label>‡∏´‡∏°‡∏π‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏î</label>
                    <select id="bloodType" class="form-control">
                        <option value="-">-</option><option value="A">A</option><option value="B">B</option><option value="O">O</option><option value="AB">AB</option>
                    </select>
                 </div>
                 <div class="form-group"><label>‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥</label><input type="text" id="nationality" class="form-control" value="‡πÑ‡∏ó‡∏¢"></div>
                 <div class="form-group"><label>‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥</label><input type="text" id="ethnicity" class="form-control" value="‡πÑ‡∏ó‡∏¢"></div>
                 <div class="form-group"><label>‡∏®‡∏≤‡∏™‡∏ô‡∏≤</label><input type="text" id="religion" class="form-control" value="‡∏û‡∏∏‡∏ó‡∏ò"></div>
              </div>
            </div>

            <div class="form-section">
                <h2>2. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà & ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h2>
                <div class="form-group">
                    <label>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</label><br>
                    <input type="radio" name="serviceArea" value="‡πÉ‡∏ô‡πÄ‡∏Ç‡∏ï" checked> ‡πÉ‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ &nbsp;
                    <input type="radio" name="serviceArea" value="‡∏ô‡∏≠‡∏Å‡πÄ‡∏Ç‡∏ï"> ‡∏ô‡∏≠‡∏Å‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
                </div>
                <div class="form-row">
                    <div class="form-group"><label>‡∏ï‡∏≥‡∏ö‡∏•</label><input type="text" id="subdistrict" class="form-control"></div>
                    <div class="form-group"><label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label><input type="text" id="district" class="form-control"></div>
                    <div class="form-group"><label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label><input type="text" id="province" class="form-control"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏î‡∏¥‡∏°</label><input type="text" id="previousSchool" class="form-control" required></div>
                    <div class="form-group"><label>‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (GPA)</label><input type="number" step="0.01" id="gpa" class="form-control" required></div>
                </div>
            </div>

            <div class="form-section">
                <h2>3. ‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</label>
                        <select id="gradeLevel" class="form-control" required>
                            <option value="‡∏°.1">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1</option>
                            <option value="‡∏°.4">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô/‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</label>
                        <div style="margin-top: 0.5rem;">
                            <input type="radio" name="program" value="‡∏ß‡∏¥‡∏ó‡∏¢‡πå-‡∏Ñ‡∏ì‡∏¥‡∏ï" checked> ‡∏ß‡∏¥‡∏ó‡∏¢‡πå-‡∏Ñ‡∏ì‡∏¥‡∏ï<br>
                            <input type="radio" name="program" value="S&M"> S&M<br>
                            <input type="radio" name="program" value="EIS"> EIS<br>
                            <input type="radio" name="program" value="GATE"> GATE
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h2>4. ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏ô‡∏ö</h2>
                <div class="form-group">
                    <input type="checkbox" name="documents" value="‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô"> ‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô &nbsp;
                    <input type="checkbox" name="documents" value="‡∏™‡∏π‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£"> ‡∏™‡∏π‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£ &nbsp;
                    <input type="checkbox" name="documents" value="‡∏õ‡∏û.1"> ‡∏õ‡∏û.1 <br>
                    <input type="checkbox" id="otherDocCheck"> ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
                    <div id="otherDocContainer" style="display:none; margin-top:0.5rem;">
                        <input type="text" id="otherDocument" class="form-control" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô‡πÜ">
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 2rem;">
                <button type="submit" id="submitBtn" class="btn btn-primary" style="font-size: 1.2rem; padding: 1rem 3rem;">
                    ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£
                </button>
                <br><br>
                <button type="button" class="btn btn-secondary" onclick="logout()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å / ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
            </div>
          </div>
        </form>
      </div>
    </div>

    <div id="adminDashboardView" class="view">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2 style="color: #2e7d32;">Admin Dashboard</h2>
                <button onclick="logout()" class="btn btn-secondary">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
            </div>
            
            <div class="form-row" style="margin-bottom: 1rem;">
                <div class="card" style="text-align: center; padding: 1.5rem;">
                    <h1 id="totalApplicants">0</h1>
                    <p>‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                </div>
                <div class="card" style="text-align: center; padding: 1.5rem;">
                    <h1 id="m1Applicants">0</h1>
                    <p>‡∏°.1</p>
                </div>
                <div class="card" style="text-align: center; padding: 1.5rem;">
                    <h1 id="m4Applicants">0</h1>
                    <p>‡∏°.4</p>
                </div>
            </div>

            <div class="card">
                <h3>‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£</h3>
                <button class="btn btn-secondary" onclick="loadAllApplicants()" style="margin-bottom: 1rem; font-size: 0.9rem;">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                <div style="overflow-x: auto;">
                    <table id="applicantsTable">
                        <thead>
                            <tr>
                                <th>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏Ø</th>
                                <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th>
                                <th>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</th>
                                <th>‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</th>
                                <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="applicantsTableBody">
                            <tr><td colspan="5" style="text-align: center;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div id="adminDetailView" class="view">
        <div class="container">
            <button onclick="backToDashboard()" class="btn btn-secondary" style="margin-bottom: 1rem;">¬´ ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</button>
            <div class="card">
                <h2 style="color: #2e7d32; border-bottom: 2px solid #ddd; padding-bottom: 0.5rem; margin-bottom: 1rem;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£</h2>
                <div id="applicantDetailContent"></div>
                
                <div style="margin-top: 2rem; border-top: 1px solid #eee; padding-top: 1rem;">
                    <label>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</label>
                    <select id="editStatus" class="form-control" style="width: auto; display: inline-block;">
                        <option value="‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡πâ‡∏ß">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡πâ‡∏ß</option>
                        <option value="‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</option>
                        <option value="‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å">‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>
                    </select>
                    <button onclick="saveStatus()" class="btn btn-primary" style="width: auto;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</button>
                </div>
            </div>
        </div>
    </div>

  </div> <div id="toast" class="toast"></div>

  <script>
    // ==========================================
    // ‚ö†Ô∏è‚ö†Ô∏è CONFIGURATION ‚ö†Ô∏è‚ö†Ô∏è
    // ‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Web App ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ Deploy ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
    // ==========================================
    const SCRIPT_URL = 'YOUR_WEB_APP_URL_HERE'; 

    let currentUser = null;
    let currentIdCard = null;
    let allApplicants = [];
    let currentApplicant = null;

    // --- Navigation Functions ---
    function showView(viewId) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(viewId).classList.add('active');
        window.scrollTo(0, 0);
    }

    function showToast(msg) {
        const t = document.getElementById('toast');
        t.innerText = msg;
        t.classList.add('show');
        setTimeout(() => t.classList.remove('show'), 3000);
    }

    function logout() {
        currentUser = null;
        currentIdCard = null;
        document.getElementById('applicationForm').reset();
        showView('studentLoginView');
    }

    // --- Student Login ---
    document.getElementById('studentLoginForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const idCard = document.getElementById('studentIdCard').value;
        if(idCard.length !== 13) { alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç 13 ‡∏´‡∏•‡∏±‡∏Å'); return; }
        
        currentIdCard = idCard;
        currentUser = 'student';
        document.getElementById('idCard').value = idCard;
        showView('applicationFormView');
        showToast('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
    });

    // --- Other Docs Checkbox ---
    document.getElementById('otherDocCheck').addEventListener('change', function(e) {
        document.getElementById('otherDocContainer').style.display = e.target.checked ? 'block' : 'none';
    });

    // --- Submit Application (To Google Sheets) ---
    document.getElementById('applicationForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const btn = document.getElementById('submitBtn');
        btn.innerHTML = '<span class="spinner"></span> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
        btn.disabled = true;

        // Collect Data
        const formData = {
            action: 'submit',
            idCard: document.getElementById('idCard').value,
            prefix: document.getElementById('prefix').value,
            firstName: document.getElementById('firstName').value,
            lastName: document.getElementById('lastName').value,
            firstNameEn: document.getElementById('firstNameEn').value,
            lastNameEn: document.getElementById('lastNameEn').value,
            birthDate: document.getElementById('birthDate').value,
            birthHospital: document.getElementById('birthHospital').value,
            bloodType: document.getElementById('bloodType').value,
            nationality: document.getElementById('nationality').value,
            ethnicity: document.getElementById('ethnicity').value,
            religion: document.getElementById('religion').value,
            serviceArea: document.querySelector('input[name="serviceArea"]:checked').value,
            subdistrict: document.getElementById('subdistrict').value,
            district: document.getElementById('district').value,
            province: document.getElementById('province').value,
            previousSchool: document.getElementById('previousSchool').value,
            gradeLevel: document.getElementById('gradeLevel').value,
            gpa: document.getElementById('gpa').value,
            program: document.querySelector('input[name="program"]:checked').value,
            documents: Array.from(document.querySelectorAll('input[name="documents"]:checked')).map(c=>c.value).join(', '),
            otherDocument: document.getElementById('otherDocument').value
        };

        // Send to Apps Script
        fetch(SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify(formData)
        })
        .then(res => res.json())
        .then(data => {
            if(data.success) {
                alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                logout();
            } else {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + data.error);
            }
        })
        .catch(err => {
            console.error(err);
            alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ');
        })
        .finally(() => {
            btn.innerHTML = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£';
            btn.disabled = false;
        });
    });

    // --- Admin System ---
    document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const u = document.getElementById('adminUsername').value;
        const p = document.getElementById('adminPassword').value;
        
        if(u === 'admin' && p === '1234') { // ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö
            currentUser = 'admin';
            showView('adminDashboardView');
            loadAllApplicants();
        } else {
            alert('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
        }
    });

    function loadAllApplicants() {
        showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');
        fetch(SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify({ action: 'getAll' })
        })
        .then(res => res.json())
        .then(result => {
            if(result.success) {
                allApplicants = result.data;
                renderDashboard();
            }
        });
    }

    function renderDashboard() {
        // Stats
        document.getElementById('totalApplicants').innerText = allApplicants.length;
        document.getElementById('m1Applicants').innerText = allApplicants.filter(a => a.gradeLevel === '‡∏°.1').length;
        document.getElementById('m4Applicants').innerText = allApplicants.filter(a => a.gradeLevel === '‡∏°.4').length;

        // Table
        const tbody = document.getElementById('applicantsTableBody');
        if(allApplicants.length === 0) {
            tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
            return;
        }
        
        let html = '';
        allApplicants.forEach((app, index) => {
            html += `
                <tr>
                    <td>${app.idCard}</td>
                    <td>${app.prefix}${app.firstName} ${app.lastName}</td>
                    <td><span class="status-badge">${app.gradeLevel}</span></td>
                    <td>${app.program}</td>
                    <td><button class="btn btn-secondary" style="padding:0.3rem 0.5rem; font-size:0.8rem;" onclick="viewDetail('${app.idCard}')">‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button></td>
                </tr>
            `;
        });
        tbody.innerHTML = html;
    }

    function viewDetail(id) {
        currentApplicant = allApplicants.find(a => a.idCard === id);
        if(!currentApplicant) return;
        
        const content = document.getElementById('applicantDetailContent');
        content.innerHTML = `
            <p><strong>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•:</strong> ${currentApplicant.prefix}${currentApplicant.firstName} ${currentApplicant.lastName}</p>
            <p><strong>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£:</strong> ${currentApplicant.idCard}</p>
            <p><strong>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏î‡∏¥‡∏°:</strong> ${currentApplicant.previousSchool} (GPA: ${currentApplicant.gpa})</p>
            <p><strong>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô:</strong> ${currentApplicant.gradeLevel} <strong>‡πÅ‡∏ú‡∏ô:</strong> ${currentApplicant.program}</p>
            <p><strong>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£:</strong> ${currentApplicant.documents} ${currentApplicant.otherDocument ? '('+currentApplicant.otherDocument+')' : ''}</p>
            <p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:</strong> <span class="status-badge">${currentApplicant.status}</span></p>
        `;
        
        // Set dropdown value
        document.getElementById('editStatus').value = currentApplicant.status || '‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡πâ‡∏ß';
        
        showView('adminDetailView');
    }

    function backToDashboard() {
        showView('adminDashboardView');
    }

    function saveStatus() {
        if(!currentApplicant) return;
        const newStatus = document.getElementById('editStatus').value;
        
        fetch(SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify({
                action: 'update',
                idCard: currentApplicant.idCard,
                status: newStatus
            })
        })
        .then(res => res.json())
        .then(data => {
            if(data.success) {
                alert('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
                currentApplicant.status = newStatus;
                viewDetail(currentApplicant.idCard); // Refresh View
                loadAllApplicants(); // Refresh Dashboard background
            }
        });
    }
  </script>
</body>
</html>
