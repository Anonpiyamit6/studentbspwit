<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô - ‡∏ö‡∏≤‡∏á‡∏™‡∏∞‡∏û‡∏≤‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Sarabun', sans-serif; background-color: #f3f4f6; }
    .hidden { display: none !important; }

    /* Paper UI Styles */
    .a4-paper {
      background: white; width: 210mm; min-height: 297mm; margin: 20px auto;
      padding: 15mm 20mm; position: relative; 
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    @media (max-width: 768px) { .a4-paper { width: 100%; padding: 10px; margin: 0; } }

    /* Inputs mimicking paper lines */
    .dot-input {
      border: none; border-bottom: 1px dotted #000; width: 100%;
      outline: none; color: #00008b; font-weight: bold; background: transparent;
      padding: 0 4px; border-radius: 0;
    }
    .chk-box {
      width: 16px; height: 16px; border: 1px solid #000; 
      display: inline-flex; align-items: center; justify-content: center;
      margin-right: 5px; cursor: pointer; vertical-align: middle;
    }
    .chk-box:checked { background: #000; }
    .chk-box:checked::after { content: '‚úì'; color: white; font-size: 12px; }
    
    /* ID Card Boxes */
    .id-segment { display: flex; gap: 2px; }
    .id-box {
      width: 20px; height: 26px; border: 1px solid #000; text-align: center;
      font-weight: bold; border-radius: 2px; font-size: 14px;
    }

    /* Photo Upload */
    .photo-area {
      width: 35mm; height: 45mm; border: 1px solid #000; background: #f9fafb;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      cursor: pointer; overflow: hidden; position: relative;
    }
    .photo-preview { width: 100%; height: 100%; object-fit: cover; position: absolute; }
  </style>
</head>
<body>

  <div id="loginSection" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-900 to-blue-700 p-4">
    <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-md text-center">
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Emblem_of_the_Ministry_of_Education_of_Thailand.svg/1200px-Emblem_of_the_Ministry_of_Education_of_Thailand.svg.png" class="h-24 mx-auto mb-4">
      <h1 class="text-2xl font-bold text-gray-800">‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
      <p class="text-gray-500 mb-6">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡∏≤‡∏á‡∏™‡∏∞‡∏û‡∏≤‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</p>
      
      <form onsubmit="handleLogin(event)">
        <div class="mb-4 text-left">
          <label class="block text-gray-700 text-sm font-bold mb-2">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô (‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô)</label>
          <input type="text" id="loginUser" maxlength="13" required
            class="w-full px-4 py-3 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:bg-white focus:outline-none text-center text-xl tracking-widest placeholder-gray-400"
            placeholder="XXXXXXXXXXXXX">
        </div>
        <button type="submit" id="btnLogin" class="w-full bg-blue-800 text-white font-bold py-3 rounded-lg hover:bg-blue-900 transition duration-300 shadow-md">
          ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
        </button>
      </form>

      <div class="mt-6 border-t pt-4">
        <p class="text-xs text-gray-400 cursor-pointer hover:text-blue-600" onclick="toggleAdmin()">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</p>
        <div id="adminLoginArea" class="hidden mt-2">
           <input type="password" id="adminPass" placeholder="Admin Password" class="border p-2 rounded text-sm w-full mb-2">
           <button type="button" onclick="handleLoginAdmin()" class="bg-gray-700 text-white text-xs py-2 px-4 rounded w-full">Login Admin</button>
        </div>
      </div>
    </div>
  </div>

  <div id="formSection" class="hidden pb-20">
    <form id="appForm" onsubmit="submitForm(event)">

      <div class="a4-paper">
         <div class="absolute top-5 right-5 text-xs text-gray-400">‡∏´‡∏ô‡πâ‡∏≤ 1</div>
         
         <div class="flex justify-between items-start mb-6">
            <div class="flex-1 text-center pt-2 pl-[35mm]"> 
               <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Emblem_of_the_Ministry_of_Education_of_Thailand.svg/1200px-Emblem_of_the_Ministry_of_Education_of_Thailand.svg.png" class="h-16 mx-auto mb-1">
               <div class="font-bold text-lg">‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡πà‡∏≠‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1</div>
               <div class="font-bold">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡∏≤‡∏á‡∏™‡∏∞‡∏û‡∏≤‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</div>
            </div>
            <div class="flex flex-col items-end">
               <div class="flex items-center text-xs mb-1">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£ <div class="border border-black w-20 h-5 ml-1"></div></div>
               <div class="photo-area" onclick="document.getElementById('fileIn').click()">
                  <span class="text-xs text-center p-2 text-gray-400">‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢ 1.5 ‡∏ô‡∏¥‡πâ‡∏ß<br>(‡∏Ñ‡∏•‡∏¥‡∏Å)</span>
                  <img id="preview" class="photo-preview hidden">
               </div>
               <input type="file" id="fileIn" class="hidden" accept="image/*" onchange="loadPhoto(this)">
            </div>
         </div>

         <div class="space-y-4 text-sm font-sarabun">
            <div>
               <div class="font-bold border-b border-black inline-block mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 1 ‡∏Ç‡πâ‡∏≠)</div>
               <div class="ml-4">
                  <label class="block"><input type="radio" name="area_status" value="‡πÉ‡∏ô‡πÄ‡∏Ç‡∏ï" class="chk-box"> ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (‡∏ï.‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î‡∏ô‡∏û‡∏Ñ‡∏∏‡∏ì, ‡∏ï.‡∏û‡∏á‡∏®‡πå‡∏õ‡∏£‡∏∞‡∏®‡∏≤‡∏™‡∏ô‡πå, ‡∏ï.‡πÅ‡∏°‡πà‡∏£‡∏≥‡∏û‡∏∂‡∏á, ‡∏ï.‡∏ó‡∏≠‡∏á‡∏°‡∏á‡∏Ñ‡∏•, ‡∏ï.‡∏£‡πà‡∏≠‡∏ô‡∏ó‡∏≠‡∏á)</label>
                  <label class="block"><input type="radio" name="area_status" value="‡∏ô‡∏≠‡∏Å‡πÄ‡∏Ç‡∏ï" class="chk-box"> ‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏≠‡∏Å‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</label>
               </div>
            </div>

            <div class="flex items-baseline">
               <span class="font-bold mr-2">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</span>
               <input name="old_school" class="dot-input">
            </div>

            <div>
               <div class="font-bold border-b border-black inline-block mb-1">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£ (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</div>
               <div class="grid grid-cols-2 ml-4 gap-2">
                  <label><input type="radio" name="program_select" value="‡∏ß‡∏¥‡∏ó‡∏¢‡πå-‡∏Ñ‡∏ì‡∏¥‡∏ï" class="chk-box"> ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡πå - ‡∏Ñ‡∏ì‡∏¥‡∏ï</label>
                  <label><input type="radio" name="program_select" value="EIS" class="chk-box"> ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô EIS</label>
                  <label><input type="radio" name="program_select" value="S&M" class="chk-box"> ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô S&M</label>
                  <label><input type="radio" name="program_select" value="GATE" class="chk-box"> ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô GATE</label>
               </div>
            </div>

            <div>
               <div class="font-bold border-b border-black inline-block mb-1">‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£</div>
               <div class="ml-4 space-y-1">
                  <div class="flex justify-between"><label><input type="checkbox" name="docs" value="‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" class="chk-box"> 1. ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label> <span>1 ‡∏â‡∏ö‡∏±‡∏ö</span></div>
                  <div class="flex justify-between"><label><input type="checkbox" name="docs" value="‡∏™‡∏π‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£" class="chk-box"> 2. ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏™‡∏π‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label> <span>1 ‡∏â‡∏ö‡∏±‡∏ö</span></div>
                  <div class="flex justify-between"><label><input type="checkbox" name="docs" value="‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ö‡∏¥‡∏î‡∏≤" class="chk-box"> 3. ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ö‡∏¥‡∏î‡∏≤</label> <span>1 ‡∏â‡∏ö‡∏±‡∏ö</span></div>
                  <div class="flex justify-between"><label><input type="checkbox" name="docs" value="‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏°‡∏≤‡∏£‡∏î‡∏≤" class="chk-box"> 4. ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏°‡∏≤‡∏£‡∏î‡∏≤</label> <span>1 ‡∏â‡∏ö‡∏±‡∏ö</span></div>
                  <div class="flex justify-between"><label><input type="checkbox" name="docs" value="‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á" class="chk-box"> 5. ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á</label> <span>1 ‡∏â‡∏ö‡∏±‡∏ö</span></div>
                  <div class="flex justify-between"><label><input type="checkbox" name="docs" value="‡∏õ‡∏û.1" class="chk-box"> 6. ‡∏õ‡∏û.1 ‡∏´‡∏£‡∏∑‡∏≠ ‡∏õ‡∏û.7</label> <span>1 ‡∏â‡∏ö‡∏±‡∏ö</span></div>
                  <div class="flex items-baseline"><label><input type="checkbox" name="docs" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ" class="chk-box"> 7. ‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏)</label> <input name="doc_other" class="dot-input w-32 mx-2"> <span>1 ‡∏â‡∏ö‡∏±‡∏ö</span></div>
               </div>
            </div>

            <div>
               <div class="font-bold border-b border-black inline-block mb-1">(1) ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</div>
               <div class="flex items-baseline gap-2 mb-2">
                  <span>‡∏ä‡∏∑‡πà‡∏≠</span>
                  <select name="prefix" class="bg-transparent border-b border-dotted border-black outline-none"><option>‡∏î.‡∏ä.</option><option>‡∏î.‡∏ç.</option><option>‡∏ô‡∏≤‡∏¢</option><option>‡∏ô.‡∏™.</option></select>
                  <input name="name_th" class="dot-input w-1/3">
                  <span>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</span>
                  <input name="surname_th" class="dot-input w-1/3">
               </div>
               <div class="flex items-baseline gap-2 mb-2">
                  <span>Name (Eng)</span> <input name="name_en" class="dot-input w-1/3">
                  <span>Surname</span> <input name="surname_en" class="dot-input w-1/3">
               </div>
               
               <div class="flex items-center gap-2 mb-2">
                  <span class="font-bold">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô:</span>
                  <div class="flex gap-3" id="idCardContainer"></div> <input type="hidden" name="idCard" id="realIdCard">
               </div>

               <div class="flex items-baseline gap-2 mb-2">
                  <span>‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î:</span> <input type="date" name="dob" class="dot-input w-40">
                  <span>‡∏£‡∏û.</span> <input name="birth_hosp" class="dot-input w-32">
               </div>
               <div class="flex items-baseline gap-2">
                   <span>‡∏ï.</span> <input name="birth_tum" class="dot-input">
                   <span>‡∏≠.</span> <input name="birth_amp" class="dot-input">
                   <span>‡∏à.</span> <input name="birth_prov" class="dot-input">
               </div>
               <div class="flex items-baseline gap-2 mt-2">
                   <span>‡∏´‡∏°‡∏π‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏î</span> <input name="blood" class="dot-input w-12">
                   <span>‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥</span> <input name="nation" class="dot-input w-16">
                   <span>‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥</span> <input name="race" class="dot-input w-16">
                   <span>‡∏®‡∏≤‡∏™‡∏ô‡∏≤</span> <input name="religion" class="dot-input w-16">
               </div>
            </div>
         </div>
      </div>

      <div class="a4-paper">
         <div class="absolute top-5 right-5 text-xs text-gray-400">‡∏´‡∏ô‡πâ‡∏≤ 2</div>
         <div class="font-bold text-lg mb-2">(2) ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</div>
         
         <div class="text-sm space-y-4">
            <div>
               <div class="font-bold underline">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≤‡∏°‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô</div>
               <div class="flex items-baseline mb-1">‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ö‡πâ‡∏≤‡∏ô <input name="reg_code" class="dot-input w-1/2"></div>
               <div class="flex items-baseline gap-2 mb-1">
                  ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà <input name="reg_no" class="dot-input w-16">
                  ‡∏´‡∏°‡∏π‡πà <input name="reg_moo" class="dot-input w-12">
                  ‡∏ñ‡∏ô‡∏ô <input name="reg_road" class="dot-input flex-1">
               </div>
               <div class="flex items-baseline gap-2 mb-1">
                  ‡∏ï‡∏≥‡∏ö‡∏• <input name="reg_tum" class="dot-input flex-1">
                  ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ <input name="reg_amp" class="dot-input flex-1">
               </div>
               <div class="flex items-baseline gap-2">
                  ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î <input name="reg_prov" class="dot-input flex-1">
                  ‡∏£‡∏´‡∏±‡∏™ ‡∏õ‡∏ì. <input name="reg_zip" class="dot-input w-20">
                  ‡πÇ‡∏ó‡∏£ <input name="reg_tel" class="dot-input w-32">
               </div>
            </div>
            
            <div>
               <div class="font-bold underline">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
               <div class="flex items-baseline mb-1">‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ö‡πâ‡∏≤‡∏ô <input name="cur_code" class="dot-input w-1/2"></div>
               <div class="flex items-baseline gap-2 mb-1">
                  ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà <input name="cur_no" class="dot-input w-16">
                  ‡∏´‡∏°‡∏π‡πà <input name="cur_moo" class="dot-input w-12">
                  ‡∏ñ‡∏ô‡∏ô <input name="cur_road" class="dot-input flex-1">
               </div>
               <div class="flex items-baseline gap-2 mb-1">
                  ‡∏ï‡∏≥‡∏ö‡∏• <input name="cur_tum" class="dot-input flex-1">
                  ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ <input name="cur_amp" class="dot-input flex-1">
               </div>
               <div class="flex items-baseline gap-2">
                  ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î <input name="cur_prov" class="dot-input flex-1">
                  ‡∏£‡∏´‡∏±‡∏™ ‡∏õ‡∏ì. <input name="cur_zip" class="dot-input w-20">
                  ‡πÇ‡∏ó‡∏£ <input name="cur_tel" class="dot-input w-32 bg-yellow-50">
               </div>
            </div>
         </div>

         <div class="font-bold text-lg mt-4 mb-2">(3) ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∑‡πà‡∏ô‡πÜ</div>
         <div class="grid grid-cols-2 gap-4 text-sm">
            <div>
               <div class="font-bold">‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏Å‡∏ô‡∏≠‡∏ô</div>
               <label class="block"><input type="radio" name="living" value="‡∏û‡πà‡∏≠‡πÅ‡∏°‡πà" class="chk-box"> ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏û‡πà‡∏≠‡πÅ‡∏°‡πà</label>
               <label class="block"><input type="radio" name="living" value="‡∏ç‡∏≤‡∏ï‡∏¥" class="chk-box"> ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ç‡∏≤‡∏ï‡∏¥</label>
               <label class="block"><input type="radio" name="living" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ" class="chk-box"> ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</label>
            </div>
            <div>
               <div class="font-bold">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πâ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™</div>
               <div class="flex items-baseline">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏° <input name="inc_total" class="dot-input w-20"> ‡∏ö./‡∏î.</div>
               <div class="flex items-baseline">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å <input name="mem_count" class="dot-input w-10"> ‡∏Ñ‡∏ô</div>
               <label class="block mt-1"><input type="radio" name="poor" value="‡∏¢‡∏≤‡∏Å‡∏à‡∏ô" class="chk-box"> ‡∏¢‡∏≤‡∏Å‡∏à‡∏ô (<= 3,000)</label>
               <label class="block"><input type="radio" name="poor" value="‡πÑ‡∏°‡πà‡∏¢‡∏≤‡∏Å‡∏à‡∏ô" class="chk-box"> ‡πÑ‡∏°‡πà‡∏¢‡∏≤‡∏Å‡∏à‡∏ô (> 3,000)</label>
            </div>
         </div>
         
         <div class="text-sm mt-4">
             <div class="font-bold">‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á</div>
             <div class="flex gap-3">
                 <label><input type="radio" name="travel" value="‡πÄ‡∏î‡∏¥‡∏ô" class="chk-box"> ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏ó‡πâ‡∏≤</label>
                 <label><input type="radio" name="travel" value="‡∏£‡∏ñ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß" class="chk-box"> ‡∏£‡∏ñ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</label>
                 <label><input type="radio" name="travel" value="‡∏£‡∏ñ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£" class="chk-box"> ‡∏£‡∏ñ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£</label>
             </div>
             <div class="flex items-baseline gap-2 mt-1">
                 ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á <input name="distance" class="dot-input w-16"> ‡∏Å‡∏°. ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ <input name="time_use" class="dot-input w-16"> ‡∏ô‡∏≤‡∏ó‡∏µ
             </div>
         </div>
      </div>

      <div class="a4-paper">
         <div class="absolute top-5 right-5 text-xs text-gray-400">‡∏´‡∏ô‡πâ‡∏≤ 3</div>
         <div class="font-bold text-lg mb-2">(5) ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß</div>
         <div class="text-sm space-y-4">
            <div class="flex items-baseline">
               <span class="font-bold mr-2">‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤:</span>
               <select name="marry_status" class="border border-black"><option>‡∏à‡∏î‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</option><option>‡πÑ‡∏°‡πà‡∏à‡∏î‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</option><option>‡∏´‡∏¢‡πà‡∏≤‡∏£‡πâ‡∏≤‡∏á</option><option>‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà</option><option>‡∏ñ‡∏∂‡∏á‡πÅ‡∏Å‡πà‡∏Å‡∏£‡∏£‡∏°</option></select>
            </div>
            
            <div class="p-2 border border-black rounded bg-gray-50">
               <div class="font-bold">‡∏ö‡∏¥‡∏î‡∏≤ (‡∏ï‡∏≤‡∏°‡∏™‡∏π‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£)</div>
               <div class="flex items-baseline">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏Ø <input name="f_id" class="dot-input w-40"></div>
               <div class="flex items-baseline">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• <input name="f_name" class="dot-input flex-1"></div>
               <div class="flex items-baseline gap-2">
                  ‡∏≠‡∏≤‡∏ä‡∏µ‡∏û <input name="f_job" class="dot-input flex-1"> ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ <input name="f_inc" class="dot-input w-24">
                  ‡πÇ‡∏ó‡∏£ <input name="f_tel" class="dot-input w-32">
               </div>
            </div>

            <div class="p-2 border border-black rounded bg-gray-50">
               <div class="font-bold">‡∏°‡∏≤‡∏£‡∏î‡∏≤ (‡∏ï‡∏≤‡∏°‡∏™‡∏π‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£)</div>
               <div class="flex items-baseline">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏Ø <input name="m_id" class="dot-input w-40"></div>
               <div class="flex items-baseline">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• <input name="m_name" class="dot-input flex-1"></div>
               <div class="flex items-baseline gap-2">
                  ‡∏≠‡∏≤‡∏ä‡∏µ‡∏û <input name="m_job" class="dot-input flex-1"> ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ <input name="m_inc" class="dot-input w-24">
                  ‡πÇ‡∏ó‡∏£ <input name="m_tel" class="dot-input w-32">
               </div>
            </div>

            <div class="p-2 border border-black rounded bg-gray-50">
               <div class="font-bold">‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏û‡πà‡∏≠‡πÅ‡∏°‡πà)</div>
               <div class="flex items-baseline">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô <input name="g_rel" class="dot-input w-32"></div>
               <div class="flex items-baseline">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• <input name="g_name" class="dot-input flex-1"></div>
               <div class="flex items-baseline gap-2">
                  ‡πÇ‡∏ó‡∏£ <input name="g_tel" class="dot-input w-32">
               </div>
            </div>

            <div class="text-center mt-8">
               ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ................................................................<br>
               ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡πà‡∏ô‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£ <input type="date" name="sign_date" class="border p-1">
            </div>
         </div>
      </div>

      <div class="a4-paper">
         <div class="absolute top-5 right-5 text-xs text-gray-400">‡∏´‡∏ô‡πâ‡∏≤ 4</div>
         <div class="font-bold text-lg border-b border-black inline-block mb-4">(‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà)</div>
         
         <div class="space-y-4">
             <label class="block p-2 hover:bg-green-50 rounded cursor-pointer">
                 <input type="radio" name="admin_check_result" value="‡∏ú‡πà‡∏≤‡∏ô" class="chk-box"> 
                 <b>‡∏ú‡πà‡∏≤‡∏ô:</b> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Ñ‡∏£‡∏ö
             </label>
             <label class="block p-2 hover:bg-red-50 rounded cursor-pointer">
                 <input type="radio" name="admin_check_result" value="‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô" class="chk-box"> 
                 <b>‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô:</b> ‡∏Ç‡∏≤‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ
                 <textarea name="missing_note" class="w-full border p-2 mt-1 h-20 bg-white" placeholder="‡∏£‡∏∞‡∏ö‡∏∏..."></textarea>
             </label>
         </div>
      </div>

      <div class="fixed bottom-0 left-0 w-full bg-white border-t p-4 flex justify-center z-50 shadow-lg">
         <button type="submit" id="btnSave" class="bg-blue-900 text-white text-lg font-bold py-3 px-16 rounded-full hover:bg-blue-800 shadow-xl transition transform hover:scale-105">
            ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
         </button>
      </div>

    </form>
  </div>

  <script>
    // üî¥üî¥üî¥ ‡πÉ‡∏™‡πà URL ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ (‡∏ï‡πâ‡∏≠‡∏á Deploy New Version ‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞) üî¥üî¥üî¥
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxtWZwXSFcbdrrPZSLrs4kmEDYB4fqx3MxUs0Wo40lgkAyIi_6C-j0AJ3YZgWOBJ16AHw/exec'; 

    let photoBase64 = null;
    let existingPhoto = null;

    // --- Init JS ---
    function init() {
       const c = document.getElementById('idCardContainer');
       [1, 4, 5, 2, 1].forEach((count, idxGroup) => {
          const div = document.createElement('div'); div.className = 'id-segment';
          for(let i=0; i<count; i++) {
             const inp = document.createElement('input');
             inp.className = 'id-box'; inp.maxLength = 1;
             inp.onkeyup = (e) => {
                inp.value = inp.value.replace(/[^0-9]/g,'');
                if(inp.value && inp.nextElementSibling) inp.nextElementSibling.focus();
                else if(inp.value && !inp.nextElementSibling && div.nextElementSibling) div.nextElementSibling.firstChild.focus();
                
                // Collect ID
                let val = '';
                document.querySelectorAll('.id-box').forEach(b => val += b.value);
                document.getElementById('realIdCard').value = val;
             };
             div.appendChild(inp);
          }
          c.appendChild(div);
       });
    }
    init();

    // --- Login ---
    function toggleAdmin(){
       document.getElementById('adminLoginArea').classList.toggle('hidden');
    }

    function handleLoginAdmin() {
       const p = document.getElementById('adminPass').value;
       const btn = event.target; btn.innerText = '...';
       fetch(SCRIPT_URL, {method:'POST', body:JSON.stringify({action:'login', username:'admin', password:p})})
       .then(r=>r.json()).then(res => {
          if(res.role === 'admin') alert('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô Demo ‡∏ü‡∏≠‡∏£‡πå‡∏°)');
          else alert('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏¥‡∏î');
       }).finally(()=>btn.innerText='Login Admin');
    }

    function handleLogin(e) {
       e.preventDefault();
       const u = document.getElementById('loginUser').value.trim();
       if(!u) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô');

       const btn = document.getElementById('btnLogin');
       const originalText = btn.innerText;
       btn.innerText = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå...'; btn.disabled = true;

       fetch(SCRIPT_URL, {method:'POST', body:JSON.stringify({action:'login', username:u, password:''})})
       .then(r => r.json())
       .then(res => {
          if(!res.success) {
             alert('‚ùå ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ: ' + res.error);
          } else {
             // Login Success
             document.getElementById('loginSection').classList.add('hidden');
             document.getElementById('formSection').classList.remove('hidden');
             window.scrollTo(0,0);
             
             // ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏•‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
             const chars = u.split('');
             document.querySelectorAll('.id-box').forEach((b,i) => { if(chars[i]) b.value = chars[i]; });
             document.getElementById('realIdCard').value = u;

             // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°
             if(res.found && res.data) {
                populate(res.data);
                if(res.data.photoUrl) {
                   document.getElementById('preview').src = res.data.photoUrl;
                   document.getElementById('preview').classList.remove('hidden');
                   existingPhoto = res.data.photoUrl;
                }
                alert('‚úÖ ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö');
             } else {
                alert('üëã ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö ' + (res.nameFromList || '') + ' ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
             }
          }
       })
       .catch(err => alert('Error: ' + err))
       .finally(() => { btn.innerText = originalText; btn.disabled = false; });
    }

    // --- Save ---
    function loadPhoto(input) {
       if (input.files && input.files[0]) {
          const reader = new FileReader();
          reader.onload = (e) => {
             document.getElementById('preview').src = e.target.result;
             document.getElementById('preview').classList.remove('hidden');
             photoBase64 = e.target.result;
          };
          reader.readAsDataURL(input.files[0]);
       }
    }

    function submitForm(e) {
       e.preventDefault();
       if(!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á?')) return;
       
       const btn = document.getElementById('btnSave');
       btn.innerText = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...'; btn.disabled = true;
       
       const fd = {};
       document.querySelectorAll('input, select, textarea').forEach(el => {
          if(el.type === 'radio') { if(el.checked) fd[el.name] = el.value; }
          else if(el.type === 'checkbox') { if(el.checked) { if(!fd[el.name]) fd[el.name]=[]; fd[el.name].push(el.value); } }
          else if(el.type !== 'file') fd[el.name] = el.value;
       });
       if(fd.docs && Array.isArray(fd.docs)) fd.docs = fd.docs.join(', ');

       if(photoBase64) fd.photoBase64 = photoBase64;
       if(existingPhoto) fd.existingPhoto = existingPhoto;

       fetch(SCRIPT_URL, {method:'POST', body:JSON.stringify({action:'save', data:fd})})
       .then(r=>r.json()).then(res => {
          if(res.success) alert('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå!');
          else alert('Error: ' + res.error);
       })
       .catch(e => alert('Error: '+e))
       .finally(()=> { btn.innerText = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'; btn.disabled = false; });
    }
    
    function populate(d) {
       Object.keys(d).forEach(k => {
          const els = document.getElementsByName(k);
          if(!els.length) return;
          if(els[0].type === 'radio') els.forEach(r => { if(r.value == d[k]) r.checked = true; });
          else if(els[0].type !== 'file') els[0].value = d[k];
       });
    }
  </script>
</body>
</html>
