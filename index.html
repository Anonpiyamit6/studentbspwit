<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£ - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡∏≤‡∏á‡∏™‡∏∞‡∏û‡∏≤‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Sarabun', sans-serif; background: #f3f4f6; }
    .hidden { display: none !important; }
    /* Login */
    .login-split { display: flex; min-height: 100vh; }
    .login-left { background-color: #1e3a8a; width: 50%; color: white; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 40px; }
    .login-right { background-color: white; width: 50%; display: flex; justify-content: center; align-items: center; padding: 40px; }
    @media (max-width: 768px) { .login-split { flex-direction: column; } .login-left, .login-right { width: 100%; min-height: 50vh; } }
    
    /* Paper Form Style */
    .paper-page { background: white; max-width: 210mm; margin: 0 auto 20px auto; padding: 20mm; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); position: relative; }
    .page-num { position: absolute; top: 10mm; right: 10mm; font-size: 0.8rem; color: #94a3b8; }
    
    /* Inputs */
    .line-input { border: none; border-bottom: 1px dotted #000; width: 100%; outline: none; background: transparent; color: #1e40af; font-weight: bold; padding: 0 5px; }
    .box-input { border: 1px solid #cbd5e1; padding: 8px; border-radius: 4px; width: 100%; }
    .check-item { display: flex; align-items: start; gap: 8px; margin-bottom: 6px; cursor: pointer; }
    .check-item input { margin-top: 5px; transform: scale(1.2); }
    
    h2 { font-size: 1.25rem; font-weight: bold; margin-bottom: 1rem; border-left: 5px solid #1e3a8a; padding-left: 10px; color: #1e3a8a; background: #eff6ff; }
    .sub-head { font-weight: bold; margin-top: 15px; margin-bottom: 5px; text-decoration: underline; color: #334155; }
  </style>
</head>
<body>

  <div id="loginSection" class="login-split">
    <div class="login-left">
      <h1 class="text-4xl font-bold mb-2">‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
      <p class="text-xl opacity-90">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡∏≤‡∏á‡∏™‡∏∞‡∏û‡∏≤‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</p>
      <div class="mt-8 text-sm text-blue-200 cursor-pointer underline" onclick="toggleRole()">‡∏™‡∏•‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà / ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
    </div>
    <div class="login-right">
      <div class="w-full max-w-md space-y-6">
        
        <div id="roleStudent">
          <h3 class="text-2xl font-bold text-gray-800 text-center mb-6">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô)</h3>
          <form onsubmit="handleLogin(event, 'student')" class="space-y-4">
            <div><label class="block font-bold mb-1">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</label>
            <input type="text" id="loginUser" maxlength="13" class="w-full p-3 border rounded text-center text-xl tracking-widest bg-gray-50" placeholder="xxxxxxxxxxxxx" required></div>
            <button type="submit" id="btnStu" class="w-full bg-blue-900 text-white py-3 rounded hover:bg-blue-800 font-bold">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</button>
          </form>
        </div>

        <div id="roleAdmin" class="hidden">
          <h3 class="text-2xl font-bold text-red-800 text-center mb-6">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà)</h3>
          <form onsubmit="handleLogin(event, 'admin')" class="space-y-4">
            <div><label>Username</label><input type="text" id="admUser" class="w-full p-2 border rounded"></div>
            <div><label>Password</label><input type="password" id="admPass" class="w-full p-2 border rounded"></div>
            <button type="submit" id="btnAdm" class="w-full bg-red-800 text-white py-3 rounded hover:bg-red-700 font-bold">Login</button>
          </form>
        </div>

      </div>
    </div>
  </div>

  <div id="adminSection" class="hidden min-h-screen p-6">
    <div class="max-w-7xl mx-auto bg-white rounded shadow-lg overflow-hidden">
       <div class="bg-gray-800 text-white p-4 flex justify-between items-center">
         <h1 class="text-xl font-bold">Admin Dashboard</h1>
         <button onclick="location.reload()" class="text-sm bg-red-600 px-3 py-1 rounded">Logout</button>
       </div>
       
       <div class="flex border-b">
         <button onclick="tab('list')" class="px-6 py-3 font-bold text-blue-900 bg-blue-50">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£</button>
         <button onclick="tab('import')" class="px-6 py-3 font-bold text-gray-500 hover:bg-gray-50">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå (Excel)</button>
       </div>

       <div id="tab-list" class="p-6">
         <table class="w-full text-left text-sm">
           <thead class="bg-gray-100 uppercase"><tr><th class="p-3">‡πÄ‡∏ß‡∏•‡∏≤</th><th class="p-3">ID</th><th class="p-3">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th><th class="p-3">‡πÅ‡∏ú‡∏ô‡∏Ø</th><th class="p-3">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th><th class="p-3">Action</th></tr></thead>
           <tbody id="tbList"></tbody>
         </table>
       </div>

       <div id="tab-import" class="p-6 hidden text-center">
         <input type="file" id="fileIn" class="border p-2" onchange="previewExcel(this)">
         <button onclick="uploadExcel()" class="bg-green-600 text-white px-4 py-2 rounded ml-2">Upload</button>
         <div id="previewCount" class="mt-2 text-gray-600"></div>
       </div>
    </div>
  </div>

  <div id="formSection" class="hidden py-8">
    
    <div id="adminEditBar" class="hidden fixed top-0 left-0 w-full bg-yellow-400 text-yellow-900 text-center py-2 font-bold z-50 shadow-md">
       ‚ö†Ô∏è ‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• <button onclick="closeEdit()" class="ml-4 bg-white border px-2 text-sm rounded">‡∏õ‡∏¥‡∏î</button>
    </div>

    <form id="appForm" onsubmit="submitForm(event)" class="space-y-6">

      <div class="paper-page">
         <span class="page-num">‡∏´‡∏ô‡πâ‡∏≤ 1</span>
         <div class="text-center mb-8">
            <h1 class="text-2xl font-bold">‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
            <p>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡∏≤‡∏á‡∏™‡∏∞‡∏û‡∏≤‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</p>
         </div>

         <h2>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</h2>
         <div class="grid md:grid-cols-2 gap-6 mb-4">
            <div>
               <label class="font-bold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà:</label>
               <div class="ml-2 mt-2 space-y-1">
                  <label class="check-item"><input type="radio" name="area_status" value="‡πÉ‡∏ô‡πÄ‡∏Ç‡∏ï"> ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (‡∏ï.‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î‡∏ô‡∏û‡∏Ñ‡∏∏‡∏ì ‡∏Ø‡∏•‡∏Ø)</label>
                  <label class="check-item"><input type="radio" name="area_status" value="‡∏ô‡∏≠‡∏Å‡πÄ‡∏Ç‡∏ï"> ‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏≠‡∏Å‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</label>
               </div>
            </div>
            <div>
               <label class="font-bold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</label>
               <input type="text" name="old_school" class="line-input">
            </div>
         </div>

         <div class="mb-4">
            <label class="font-bold">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£ (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£):</label>
            <div class="grid grid-cols-2 gap-2 mt-2 ml-2">
               <label class="check-item"><input type="radio" name="program_select" value="‡∏ß‡∏¥‡∏ó‡∏¢‡πå-‡∏Ñ‡∏ì‡∏¥‡∏ï"> ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡πå - ‡∏Ñ‡∏ì‡∏¥‡∏ï</label>
               <label class="check-item"><input type="radio" name="program_select" value="EIS"> ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô EIS</label>
               <label class="check-item"><input type="radio" name="program_select" value="S&M"> ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô S&M</label>
               <label class="check-item"><input type="radio" name="program_select" value="GATE"> ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô GATE</label>
            </div>
         </div>

         <div class="mb-6 p-4 border rounded bg-gray-50">
            <label class="font-bold block mb-2">‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£ (Checklist)</label>
            <div class="grid grid-cols-1 gap-2 text-sm">
               <label class="check-item"><input type="checkbox" name="docs" value="‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô"> 1. ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
               <label class="check-item"><input type="checkbox" name="docs" value="‡∏™‡∏π‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£"> 2. ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏™‡∏π‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
               <label class="check-item"><input type="checkbox" name="docs" value="‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ö‡∏¥‡∏î‡∏≤"> 3. ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ö‡∏¥‡∏î‡∏≤</label>
               <label class="check-item"><input type="checkbox" name="docs" value="‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏°‡∏≤‡∏£‡∏î‡∏≤"> 4. ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
               <label class="check-item"><input type="checkbox" name="docs" value="‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á"> 5. ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á</label>
               <label class="check-item"><input type="checkbox" name="docs" value="‡∏õ‡∏û.1"> 6. ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ (‡∏õ‡∏û.7 ‡∏´‡∏£‡∏∑‡∏≠ ‡∏õ‡∏û.1)</label>
               <div class="flex items-center gap-2">
                  <input type="checkbox" name="docs" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ"> 7. ‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏) <input type="text" name="doc_other_detail" class="line-input w-1/2">
               </div>
            </div>
         </div>

         <h2>(1) ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</h2>
         <div class="flex flex-wrap gap-4 mb-2">
            <div class="w-32">‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ <select name="prefix" class="line-input"><option>‡∏î.‡∏ä.</option><option>‡∏î.‡∏ç.</option><option>‡∏ô‡∏≤‡∏¢</option><option>‡∏ô.‡∏™.</option></select></div>
            <div class="flex-1">‡∏ä‡∏∑‡πà‡∏≠ <input type="text" name="name_th" class="line-input"></div>
            <div class="flex-1">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <input type="text" name="surname_th" class="line-input"></div>
         </div>
         <div class="flex flex-wrap gap-4 mb-2">
            <div class="flex-1">Name (Eng) <input type="text" name="name_en" class="line-input"></div>
            <div class="flex-1">Surname (Eng) <input type="text" name="surname_en" class="line-input"></div>
         </div>
         <div class="flex flex-wrap gap-4 mb-2">
            <div class="flex-1">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô <input type="text" id="idCard" name="idCard" readonly class="line-input bg-gray-100"></div>
            <div class="flex-1">‡∏ß‡∏±‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î <input type="date" name="dob" class="line-input"></div>
         </div>
         <div class="mb-2">
            ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î: ‡∏£‡∏û.<input type="text" name="birth_hosp" class="line-input w-24"> 
            ‡∏ï.<input type="text" name="birth_tumbon" class="line-input w-24"> 
            ‡∏≠.<input type="text" name="birth_amphoe" class="line-input w-24"> 
            ‡∏à.<input type="text" name="birth_province" class="line-input w-24">
         </div>
         <div class="flex gap-2">
            <span class="w-1/4">‡∏´‡∏°‡∏π‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏î <input name="blood" class="line-input w-12"></span>
            <span class="w-1/4">‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥ <input name="nation" class="line-input w-16"></span>
            <span class="w-1/4">‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥ <input name="race" class="line-input w-16"></span>
            <span class="w-1/4">‡∏®‡∏≤‡∏™‡∏ô‡∏≤ <input name="religion" class="line-input w-16"></span>
         </div>
      </div>

      <div class="paper-page">
         <span class="page-num">‡∏´‡∏ô‡πâ‡∏≤ 2</span>
         <h2>(2) ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</h2>
         
         <div class="sub-head">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≤‡∏°‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô</div>
         <div class="grid grid-cols-1 gap-2 mb-4">
            <div>‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ö‡πâ‡∏≤‡∏ô: <input name="reg_house_code" class="line-input w-1/2"></div>
            <div>
               ‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà <input name="reg_no" class="line-input w-16"> 
               ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà <input name="reg_moo" class="line-input w-12"> 
               ‡∏ñ‡∏ô‡∏ô/‡∏ã‡∏≠‡∏¢ <input name="reg_road" class="line-input w-1/2">
            </div>
            <div>
               ‡∏ï‡∏≥‡∏ö‡∏• <input name="reg_tum" class="line-input w-32"> 
               ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ <input name="reg_amp" class="line-input w-32"> 
               ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î <input name="reg_prov" class="line-input w-32">
            </div>
            <div>
               ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå <input name="reg_zip" class="line-input w-24"> 
               ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå <input name="reg_phone" class="line-input w-40">
            </div>
         </div>

         <div class="sub-head">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
         <div class="grid grid-cols-1 gap-2 mb-6">
            <div>‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ö‡πâ‡∏≤‡∏ô: <input name="cur_house_code" class="line-input w-1/2"></div>
            <div>
               ‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà <input name="cur_no" class="line-input w-16"> 
               ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà <input name="cur_moo" class="line-input w-12"> 
               ‡∏ñ‡∏ô‡∏ô/‡∏ã‡∏≠‡∏¢ <input name="cur_road" class="line-input w-1/2">
            </div>
            <div>
               ‡∏ï‡∏≥‡∏ö‡∏• <input name="cur_tum" class="line-input w-32"> 
               ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ <input name="cur_amp" class="line-input w-32"> 
               ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î <input name="cur_prov" class="line-input w-32">
            </div>
            <div>
               ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå <input name="cur_zip" class="line-input w-24"> 
               ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå <input name="phone_student" required class="line-input w-40 bg-yellow-50">
            </div>
         </div>

         <h2>(3) ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
         <div class="grid md:grid-cols-2 gap-6">
            <div>
               <div class="font-bold">‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏Å‡∏ô‡∏≠‡∏ô:</div>
               <div class="ml-2">
                  <label class="check-item"><input type="radio" name="living_status" value="‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤"> ‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
                  <label class="check-item"><input type="radio" name="living_status" value="‡∏ç‡∏≤‡∏ï‡∏¥"> ‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ç‡∏≤‡∏ï‡∏¥</label>
                  <label class="check-item"><input type="radio" name="living_status" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ"> ‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏) <input name="living_other" class="line-input w-32"></label>
               </div>
            </div>
            <div>
               <div class="font-bold">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πâ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™/‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ:</div>
               <div class="text-sm space-y-2">
                  <div>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏° <input name="fam_income_total" type="number" class="line-input w-24"> ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
                  <div>‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å <input name="fam_members" type="number" class="line-input w-16"> ‡∏Ñ‡∏ô</div>
                  <div>‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ <input name="fam_income_avg" type="number" class="line-input w-24"> ‡∏ö‡∏≤‡∏ó/‡∏Ñ‡∏ô</div>
                  <label class="check-item mt-2"><input type="radio" name="poverty_status" value="‡∏¢‡∏≤‡∏Å‡∏à‡∏ô"> ‡∏¢‡∏≤‡∏Å‡∏à‡∏ô (‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ <= 3,000)</label>
                  <label class="check-item"><input type="radio" name="poverty_status" value="‡πÑ‡∏°‡πà‡∏¢‡∏≤‡∏Å‡∏à‡∏ô"> ‡πÑ‡∏°‡πà‡∏¢‡∏≤‡∏Å‡∏à‡∏ô (‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ > 3,000)</label>
               </div>
            </div>
         </div>

         <div class="mt-4">
            <div class="font-bold">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≤‡∏î‡πÅ‡∏Ñ‡∏•‡∏ô:</div>
            <div class="flex flex-wrap gap-4 ml-2">
               <label class="check-item"><input type="checkbox" name="lacking" value="‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ô"> ‡∏Ç‡∏≤‡∏î‡πÅ‡∏Ñ‡∏•‡∏ô‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
               <label class="check-item"><input type="checkbox" name="lacking" value="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏ö‡∏ö"> ‡∏Ç‡∏≤‡∏î‡πÅ‡∏Ñ‡∏•‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏ö‡∏ö</label>
               <label class="check-item"><input type="checkbox" name="lacking" value="‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô"> ‡∏Ç‡∏≤‡∏î‡πÅ‡∏Ñ‡∏•‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô</label>
               <label class="check-item"><input type="checkbox" name="lacking" value="‡πÑ‡∏°‡πà‡∏Ç‡∏≤‡∏î‡πÅ‡∏Ñ‡∏•‡∏ô"> ‡πÑ‡∏°‡πà‡∏Ç‡∏≤‡∏î‡πÅ‡∏Ñ‡∏•‡∏ô</label>
            </div>
         </div>

         <div class="mt-4 border-t pt-2">
            <div class="font-bold">‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á:</div>
            <div class="flex gap-4 mb-2">
               <label class="check-item"><input type="radio" name="commute_type" value="‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏ó‡πâ‡∏≤"> ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏ó‡πâ‡∏≤</label>
               <label class="check-item"><input type="radio" name="commute_type" value="‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏µ‡∏¢‡∏Ñ‡πà‡∏≤‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£"> ‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏µ‡∏¢‡∏Ñ‡πà‡∏≤‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£</label>
               <label class="check-item"><input type="radio" name="commute_type" value="‡πÄ‡∏™‡∏µ‡∏¢‡∏Ñ‡πà‡∏≤‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£"> ‡πÄ‡∏™‡∏µ‡∏¢‡∏Ñ‡πà‡∏≤‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£</label>
            </div>
            <div>‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ <input name="commute_time" class="line-input w-16"> ‡∏ô‡∏≤‡∏ó‡∏µ</div>
            <div>‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á (‡∏•‡∏π‡∏Å‡∏£‡∏±‡∏á) <input name="dist_dirt" class="line-input w-16"> ‡∏°. (‡∏•‡∏≤‡∏î‡∏¢‡∏≤‡∏á/‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏£‡∏µ‡∏ï) <input name="dist_road" class="line-input w-16"> ‡∏°.</div>
         </div>

         <h2>(4) ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
         <div class="flex gap-8">
            <div>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å <input name="weight" type="number" class="line-input w-24"> ‡∏Å‡∏Å.</div>
            <div>‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á <input name="height" type="number" class="line-input w-24"> ‡∏ã‡∏°.</div>
         </div>
      </div>

      <div class="paper-page">
         <span class="page-num">‡∏´‡∏ô‡πâ‡∏≤ 3</span>
         <h2>(5) ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß</h2>
         
         <div class="mb-4">
             <label class="font-bold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏ö‡∏¥‡∏î‡∏≤ ‡∏°‡∏≤‡∏£‡∏î‡∏≤:</label>
             <select name="parents_status" class="box-input w-full md:w-1/2">
                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                <option>‡∏à‡∏î‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡∏£‡∏™</option><option>‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏à‡∏î‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡∏£‡∏™</option><option>‡∏´‡∏¢‡πà‡∏≤‡∏£‡πâ‡∏≤‡∏á</option>
                <option>‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà</option><option>‡∏ö‡∏¥‡∏î‡∏≤‡∏ñ‡∏∂‡∏á‡πÅ‡∏Å‡πà‡∏Å‡∏£‡∏£‡∏°</option><option>‡∏°‡∏≤‡∏£‡∏î‡∏≤‡∏ñ‡∏∂‡∏á‡πÅ‡∏Å‡πà‡∏Å‡∏£‡∏£‡∏°</option><option>‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤‡∏ñ‡∏∂‡∏á‡πÅ‡∏Å‡πà‡∏Å‡∏£‡∏£‡∏°</option>
             </select>
         </div>

         <div class="mb-4 p-3 bg-gray-50 border rounded">
             <div class="font-bold mb-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á:</div>
             <div class="grid grid-cols-2 md:grid-cols-5 gap-2 text-sm">
                <div>‡∏û‡∏µ‡πà‡∏ä‡∏≤‡∏¢ <input name="sib_bro_old" type="number" class="line-input w-10"> ‡∏Ñ‡∏ô</div>
                <div>‡∏û‡∏µ‡πà‡∏™‡∏≤‡∏ß <input name="sib_sis_old" type="number" class="line-input w-10"> ‡∏Ñ‡∏ô</div>
                <div>‡∏ô‡πâ‡∏≠‡∏á‡∏ä‡∏≤‡∏¢ <input name="sib_bro_yng" type="number" class="line-input w-10"> ‡∏Ñ‡∏ô</div>
                <div>‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏≤‡∏ß <input name="sib_sis_yng" type="number" class="line-input w-10"> ‡∏Ñ‡∏ô</div>
                <div>‡∏ô‡∏£.‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏∏‡∏ï‡∏£‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà <input name="child_order" type="number" class="line-input w-10"></div>
             </div>
             <div class="mt-2 text-sm">‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏≠‡∏¢‡∏π‡πà (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô) <input name="sib_studying" type="number" class="line-input w-12"> ‡∏Ñ‡∏ô</div>
         </div>

         <div class="sub-head text-blue-800">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏¥‡∏î‡∏≤ (‡∏ï‡∏≤‡∏°‡∏™‡∏π‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£)</div>
         <div class="grid gap-2 text-sm">
             <div>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£ ‡∏õ‡∏ä‡∏ä: <input name="father_id" class="line-input w-1/2"></div>
             <div>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•: <input name="father_name" class="line-input w-3/4"></div>
             <div>‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥ <input name="father_race" class="line-input w-16"> ‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥ <input name="father_nat" class="line-input w-16"> ‡∏®‡∏≤‡∏™‡∏ô‡∏≤ <input name="father_rel" class="line-input w-16"> ‡πÄ‡∏•‡∏∑‡∏≠‡∏î <input name="father_blood" class="line-input w-12"></div>
             <div>‡∏≠‡∏≤‡∏ä‡∏µ‡∏û <input name="father_job" class="line-input w-32"> ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ <input name="father_income" class="line-input w-24"> ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
             <div>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ <input name="father_phone" class="line-input w-40"></div>
         </div>

         <div class="sub-head text-pink-800 mt-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏£‡∏î‡∏≤ (‡∏ï‡∏≤‡∏°‡∏™‡∏π‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£)</div>
         <div class="grid gap-2 text-sm">
             <div>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£ ‡∏õ‡∏ä‡∏ä: <input name="mother_id" class="line-input w-1/2"></div>
             <div>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•: <input name="mother_name" class="line-input w-3/4"></div>
             <div>‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ä‡∏≤‡∏ï‡∏¥ <input name="mother_race" class="line-input w-16"> ‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥ <input name="mother_nat" class="line-input w-16"> ‡∏®‡∏≤‡∏™‡∏ô‡∏≤ <input name="mother_rel" class="line-input w-16"> ‡πÄ‡∏•‡∏∑‡∏≠‡∏î <input name="mother_blood" class="line-input w-12"></div>
             <div>‡∏≠‡∏≤‡∏ä‡∏µ‡∏û <input name="mother_job" class="line-input w-32"> ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ <input name="mother_income" class="line-input w-24"> ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
             <div>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ <input name="mother_phone" class="line-input w-40"></div>
         </div>

         <div class="sub-head text-gray-800 mt-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á (‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏û‡πà‡∏≠‡πÅ‡∏°‡πà)</div>
         <div class="grid gap-2 text-sm">
             <div>‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô <input name="guard_relation" class="line-input w-32"> ‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
             <div>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•: <input name="guard_name" class="line-input w-3/4"></div>
             <div>‡∏≠‡∏≤‡∏ä‡∏µ‡∏û <input name="guard_job" class="line-input w-32"> ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ <input name="guard_income" class="line-input w-24"> ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
             <div>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ <input name="guard_phone" class="line-input w-40"></div>
         </div>

         <div class="mt-4 p-2 bg-yellow-50 border">
            ‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á‡∏Ç‡∏ì‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: 
            <label class="inline-flex items-center ml-2"><input type="radio" name="current_guardian" value="‡∏ö‡∏¥‡∏î‡∏≤"> ‡∏ö‡∏¥‡∏î‡∏≤</label>
            <label class="inline-flex items-center ml-2"><input type="radio" name="current_guardian" value="‡∏°‡∏≤‡∏£‡∏î‡∏≤"> ‡∏°‡∏≤‡∏£‡∏î‡∏≤</label>
            <label class="inline-flex items-center ml-2"><input type="radio" name="current_guardian" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ"> ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</label>
         </div>

         <div class="mt-8 text-center">
            <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£ .....................................................................</p>
            <p class="mt-2">( ..................................................................... )</p>
            <p class="mt-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡πà‡∏ô‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£ <input type="date" name="student_sign_date" class="border p-1"></p>
         </div>
      </div>

      <div id="page4_admin" class="paper-page border-4 border-red-500 hidden">
         <span class="page-num">‡∏´‡∏ô‡πâ‡∏≤ 4 (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà)</span>
         <h2 class="bg-red-100 text-red-900 border-red-800">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</h2>
         
         <div class="space-y-4 p-4">
            <label class="block p-3 bg-green-50 border border-green-200 rounded cursor-pointer">
               <input type="radio" name="admin_check_result" value="‡∏ú‡πà‡∏≤‡∏ô" class="transform scale-150 mr-2"> 
               <span class="font-bold text-green-900">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô (‡∏ú‡πà‡∏≤‡∏ô)</span>
            </label>
            
            <label class="block p-3 bg-red-50 border border-red-200 rounded cursor-pointer">
               <input type="radio" name="admin_check_result" value="‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô" class="transform scale-150 mr-2">
               <span class="font-bold text-red-900">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏Ç‡∏≤‡∏î‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:</span>
               <textarea name="admin_check_missing_detail" class="w-full mt-2 p-2 border rounded" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î..."></textarea>
            </label>
         </div>

         <div class="grid md:grid-cols-2 gap-8 mt-8">
            <div class="text-center border p-4">
               <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô</p>
               <input name="staff_check_name" class="line-input text-center mt-4" placeholder="‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à">
               <div class="mt-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <input type="date" name="staff_check_date"></div>
            </div>
            <div class="text-center border p-4">
               <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£</p>
               <input name="staff_rec_name" class="line-input text-center mt-4" placeholder="‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£">
               <div class="mt-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <input type="date" name="staff_rec_date"></div>
            </div>
         </div>
      </div>

      <div class="fixed bottom-0 left-0 w-full bg-white shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] p-4 flex justify-center z-40">
         <button type="submit" id="btnSave" class="bg-blue-900 text-white text-xl font-bold py-3 px-12 rounded-full hover:bg-blue-800 shadow-lg transform transition hover:scale-105">
            üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£
         </button>
      </div>
      <div class="h-20"></div>

    </form>
  </div>

  <script>
    // üî¥üî¥ URL SCRIPT ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì üî¥üî¥
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxtWZwXSFcbdrrPZSLrs4kmEDYB4fqx3MxUs0Wo40lgkAyIi_6C-j0AJ3YZgWOBJ16AHw/exec'; 

    let allData = [];
    let importData = [];

    function toggleRole() {
      document.getElementById('roleStudent').classList.toggle('hidden');
      document.getElementById('roleAdmin').classList.toggle('hidden');
    }
    
    // --- Login ---
    function handleLogin(e, role) {
      e.preventDefault();
      const u = role==='student' ? document.getElementById('loginUser').value : document.getElementById('admUser').value;
      const p = role==='student' ? '' : document.getElementById('admPass').value;
      const btn = role==='student' ? document.getElementById('btnStu') : document.getElementById('btnAdm');
      
      const txt = btn.innerText; btn.innerText='Checking...'; btn.disabled=true;

      fetch(SCRIPT_URL, {method:'POST', body:JSON.stringify({action:'login', username:u, password:p})})
      .then(r=>r.json()).then(res => {
         if(!res.success && res.error) return alert(res.error);
         
         document.getElementById('loginSection').classList.add('hidden');
         
         if(res.role === 'admin') {
            document.getElementById('adminSection').classList.remove('hidden');
            allData = res.data;
            renderList();
         } else {
            document.getElementById('formSection').classList.remove('hidden');
            document.getElementById('idCard').value = u;
            if(res.found && res.data) {
               populate(res.data);
               alert('‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
            }
         }
      })
      .catch(e=>alert('Err: '+e))
      .finally(()=>{ btn.innerText=txt; btn.disabled=false; });
    }

    // --- Save Form ---
    function submitForm(e) {
      e.preventDefault();
      const btn = document.getElementById('btnSave');
      btn.innerText='‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...'; btn.disabled=true;

      const fd = {};
      document.querySelectorAll('input, select, textarea').forEach(el => {
         if(el.type==='checkbox') {
            if(!fd[el.name]) fd[el.name]=[];
            if(el.checked) fd[el.name].push(el.value);
         } else if(el.type==='radio') {
            if(el.checked) fd[el.name]=el.value;
         } else {
            fd[el.id||el.name] = el.value;
         }
      });
      // Join Arrays
      if(fd.docs) fd.docs = fd.docs.join(', ');
      if(fd.lacking) fd.lacking = fd.lacking.join(', ');

      fetch(SCRIPT_URL, {method:'POST', body:JSON.stringify({action:'save', data:fd})})
      .then(r=>r.json()).then(res => {
         if(res.success) {
            alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');
            if(!document.getElementById('adminEditBar').classList.contains('hidden')) closeEdit();
         } else alert('Error: '+res.error);
      })
      .finally(()=>{ btn.innerText='üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£'; btn.disabled=false; });
    }

    function populate(d) {
      document.querySelectorAll('input, select, textarea').forEach(el => {
         if(el.type==='checkbox') {
             if(d[el.name] && d[el.name].includes(el.value)) el.checked=true;
         } else if(el.type==='radio') {
             if(d[el.name] == el.value) el.checked=true;
         } else {
             if(d[el.id||el.name]) el.value = d[el.id||el.name];
         }
      });
    }

    // --- Admin Funcs ---
    function tab(t) {
       document.getElementById('tab-list').classList.add('hidden');
       document.getElementById('tab-import').classList.add('hidden');
       document.getElementById('tab-'+t).classList.remove('hidden');
    }
    
    function renderList() {
       const tb = document.getElementById('tbList'); tb.innerHTML='';
       allData.forEach((d, i) => {
          tb.innerHTML += `<tr class="border-b hover:bg-gray-50">
            <td class="p-3 text-xs text-gray-500">${new Date().toLocaleDateString()}</td>
            <td class="p-3 font-mono font-bold text-blue-800">${d.idCard}</td>
            <td class="p-3">${d.name_th||'-'}</td>
            <td class="p-3"><span class="bg-blue-100 text-blue-800 px-2 rounded text-xs">${d.program_select||'-'}</span></td>
            <td class="p-3">${d.admin_check_result||'‡∏£‡∏≠'}</td>
            <td class="p-3"><button onclick="edit(${i})" class="text-yellow-600 font-bold underline">‡∏ï‡∏£‡∏ß‡∏à/‡πÅ‡∏Å‡πâ</button></td>
          </tr>`;
       });
    }

    function edit(i) {
       const d = allData[i];
       document.getElementById('adminSection').classList.add('hidden');
       document.getElementById('formSection').classList.remove('hidden');
       document.getElementById('adminEditBar').classList.remove('hidden');
       document.getElementById('page4_admin').classList.remove('hidden'); // Show Page 4 for Admin
       populate(d);
    }

    function closeEdit() {
       document.getElementById('appForm').reset();
       document.getElementById('formSection').classList.add('hidden');
       document.getElementById('adminSection').classList.remove('hidden');
       document.getElementById('adminEditBar').classList.add('hidden');
       document.getElementById('page4_admin').classList.add('hidden');
    }
    
    function previewExcel(inp) {
       const r = new FileReader();
       r.onload = e => {
          const wb = XLSX.read(e.target.result, {type:'array'});
          const rows = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]], {header:1});
          importData = rows.map(r=>({id:r[0], name:r[1]})).filter(x=>x.id);
          document.getElementById('previewCount').innerText = `‡∏û‡∏ö ${importData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
       };
       r.readAsArrayBuffer(inp.files[0]);
    }
    
    function uploadExcel() {
       if(!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡πâ‡∏≤‡∏á')) return;
       fetch(SCRIPT_URL, {method:'POST', body:JSON.stringify({action:'updateWhitelist', listData:importData})})
       .then(r=>r.json()).then(res => { alert('Success'); location.reload(); });
    }
  </script>
</body>
</html>
